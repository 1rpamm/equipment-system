- model_class = Equipment
.page-header
  %h1 Оборудование
%ul#Tab.nav.nav-tabs
  %li.active=link_to "Новое оборудование", "#new_equip", "data-toggle"=>"tab"
  %li=link_to "Принятое оборудование", "#accepted_equip", "data-toggle"=>"tab"
  %li=link_to "Удаленное оборудование", "#deleted_equip", "data-toggle"=>"tab"
  -if current_user.responsible?
    %li=link_to "Ваше оборудование", "#your_equip", "data-toggle"=>"tab"
.tab-content
  #new_equip.tab-pane.active
    %table.table.table-condensed.table-hover
      %thead
        %tr
          %th= model_class.human_attribute_name(:inventory_id)
          %th= model_class.human_attribute_name(:room_id)
          %th= model_class.human_attribute_name(:responsible_id)
          %th= model_class.human_attribute_name(:domain_name)
          %th= model_class.human_attribute_name(:created_at)
          %th=t '.actions', :default => t("helpers.actions")
      %tbody
        - new_equipment = @equipment.where(:accepted_at => nil).where(:deleted_at => nil)
        - new_equipment.each do |equipment|
          %tr.info
            %td
              -if equipment.inventory
                = equipment.inventory.act_num
            %td
              -if equipment.room
                = equipment.room.name
            %td
              -if equipment.responsible
                = equipment.responsible.name
            %td= equipment.domain_name
            %td=l equipment.created_at, format: :long
            %td
              .btn-group
                = link_to t('.show', :default => t("helpers.links.show")), equipment_path(equipment), :class => 'btn btn-mini btn-info'
                -if admin_equip?
                  %button.btn.btn-mini.btn-info.dropdown-toggle(data-toggle="dropdown")
                    %span.caret
                  %ul.dropdown-menu
                    %li= link_to t('.edit', :default => t("helpers.links.edit")), edit_equipment_path(equipment)
                    %li= link_to t('.destroy', :default => t("helpers.links.destroy")), equipment_path(equipment), :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm")) }
      -#=paginate new_equipment
  #accepted_equip.tab-pane.active
    %table.table.table-condensed.table-hover
      %thead
        %tr
          %th= model_class.human_attribute_name(:inventory_id)
          %th= model_class.human_attribute_name(:room_id)
          %th= model_class.human_attribute_name(:responsible_id)
          %th= model_class.human_attribute_name(:domain_name)
          %th= model_class.human_attribute_name(:accepted_at)
          %th=t '.actions', :default => t("helpers.actions")
      %tbody
        - accepted_equipment = @equipment.where(:accepted_at => (Time.now - 1.year)..Time.now).where(:deleted_at => nil)
        - accepted_equipment.each do |equipment|
          %tr.success
            %td
              -if equipment.inventory
                = equipment.inventory.act_num
            %td
              -if equipment.room
                = equipment.room.name
            %td
              -if equipment.responsible
                = equipment.responsible.name
            %td= equipment.domain_name
            %td=l equipment.accepted_at, format: :long
            %td
              .btn-group
                = link_to t('.show', :default => t("helpers.links.show")), equipment_path(equipment), :class => 'btn btn-mini btn-success'
                -if admin_equip?
                  %button.btn.btn-mini.btn-success.dropdown-toggle(data-toggle="dropdown")
                    %span.caret
                  %ul.dropdown-menu
                    %li= link_to t('.edit', :default => t("helpers.links.edit")), edit_equipment_path(equipment)
                    %li= link_to t('.destroy', :default => t("helpers.links.destroy")), equipment_path(equipment), :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm")) }
        -#=paginate accepted_equipment
  #deleted_equip.tab-pane.active
    %table.table.table-condensed.table-hover
      %thead
        %tr
          %th= model_class.human_attribute_name(:inventory_id)
          %th= model_class.human_attribute_name(:room_id)
          %th= model_class.human_attribute_name(:responsible_id)
          %th= model_class.human_attribute_name(:domain_name)
          %th= model_class.human_attribute_name(:deleted_at)
          %th=t '.actions', :default => t("helpers.actions")
      %tbody
        - deleted_equipment = @equipment.where(:deleted_at => (Time.now - 1.year)..Time.now)
        - deleted_equipment.each do |equipment|
          %tr.error
            %td
              -if equipment.inventory
                = equipment.inventory.act_num
            %td
              -if equipment.room
                = equipment.room.name
            %td
              -if equipment.responsible
                = equipment.responsible.name
            %td= equipment.domain_name
            %td
              %b=l equipment.deleted_at, format: :long
            %td
              .btn-group
                = link_to t('.show', :default => t("helpers.links.show")), equipment_path(equipment), :class => 'btn btn-mini btn-danger'
                -if admin_equip?
                  %button.btn.btn-mini.btn-danger.dropdown-toggle(data-toggle="dropdown")
                    %span.caret
                %ul.dropdown-menu
                  %li= link_to t('.edit', :default => t("helpers.links.edit")), edit_equipment_path(equipment)
                  %li= link_to "Восстановить", equipment_path(equipment), :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm")) }
        -#=paginate deleted_equipment
  #your_equip.tab-pane.active
    %table.table.table-condensed.table-hover
      %thead
        %tr
          %th= model_class.human_attribute_name(:inventory_id)
          %th= model_class.human_attribute_name(:room_id)
          %th= model_class.human_attribute_name(:responsible_id)
          %th= model_class.human_attribute_name(:domain_name)
          %th= model_class.human_attribute_name(:accepted_at)
          %th=t '.actions', :default => t("helpers.actions")
      %tbody
        - your_equipment = @equipment.where(:responsible_id => current_user.id).order(:domain_name)
        - your_equipment.each do |equipment|
          %tr.info
            %td
              -if equipment.inventory
                = equipment.inventory.act_num
            %td
              -if equipment.room
                = equipment.room.name
            %td
              -if equipment.responsible
                = equipment.responsible.name
            %td= equipment.domain_name
            %td
              -if equipment.accepted_at
                =l equipment.accepted_at, format: :long
              -else
                .label-important
                  %center
                    %b НЕ ПРИНЯТО
            %td
              .btn-group
                = link_to t('.show', :default => t("helpers.links.show")), equipment_path(equipment), :class => 'btn btn-mini btn-info'
                -if admin_equip?
                  %button.btn.btn-mini.btn-info.dropdown-toggle(data-toggle="dropdown")
                    %span.caret
                %ul.dropdown-menu
                  %li= link_to t('.edit', :default => t("helpers.links.edit")), edit_equipment_path(equipment)
                  %li= link_to "Восстановить", equipment_path(equipment), :method => :delete, :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm")) }
        -#=paginate your_equipment
-if logged_in? && current_user.admin_user?
  %p
    = link_to"Новое оборудование", new_equipment_path, class: "btn btn-info"